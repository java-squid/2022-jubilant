# Command Query Responsibility Segregation

먼저 각 단어의 의미를 파악하자

Command Query
Command: 시스템 데이터 변경 (주문취소, 배송완료 등)
Query: 시스템의 데이터를 조회하는 것을 쿼리라고 함 (주문 목록 등)

Responsibility Segregation
Responsibility: 구성 요소의 역할 (클래스/함수, 모듈/패키지, 서버/DB)
Segregation: 역할에따라 구성요소를 나눔

시스템데이터변경 역할을 수행하는 구성요소와 시스템데이터를 조회하는 역할을 나누는것을 CQRS라고함
즉, CUD(Command)와 R(Query)을 나누는 것.

물론 코드만 나누는게 아니라 규모에 따라 서버나 프로세스를 나눈다는 의미도 될 수 있음

## 그런데 CQRS하면 뭐가 좋은걸까?

### 단일모델 사용의문제점
- 예를들어 멤버 엔티티에 마지막에 lastLoginTime 컬럼을 추가한다
- 또 뭔가를 추가해달라고한다
- 회원이름변경기능을 구현해야해서 뭔가 또추가했다
- 한 모델에 이것저것넣으면서 코드가 잡탕이된다
- 때문에 유지보수가 힘들어진다 
- 연관매핑 모두 단일모델로하면, 어떤 로딩방식을 취할지는 기능에따라 다를것이다
- 예를들어 주문취소는 유저를 eager로 로딩할필요가 없고, 주문을 조회하는건 사용자를 보여줘야하니까 eager로 하고싶을것이다
- 이렇게 달라지니까 단일모델을 유지하려면 복잡하고 어렵다

### 왜 커맨드와 쿼리를 한곳에 두면 유지보수성이 떨어지는가?

계속 공부하고 업데이트 예정

/**
명령과 쿼리가 데이터가 달라지기 때문에
예를 들어 주문취소할때 가지는 엔티티들은 그 범위가 좁다
회원목록조회, 주문목록조회 같은건 여러 영역을 데이터한다

명령과쿼리는 코드변경빈도와 사용자도 다르다
기능마다 트래픽패턴이 달라진다


그래서 명령과 쿼리를 분리하면 유지보수 좋아질 가능성이좋자
쿼리쪽은 캐시 명령은 비동기하면  성능 향상이 가능하다

구현법
1. 명령과 쿼리가 같은 프로세스냐 다른프로세스냐 같은디비냐 다른디비냐
*/

---



